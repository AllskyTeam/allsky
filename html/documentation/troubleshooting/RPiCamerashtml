<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<script src="../js/documentation.js" type="application/javascript"></script>
	<link href="../css/light.css" rel="stylesheet">
	<link href="../bower_components/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
	<script src="../bower_components/jquery/dist/jquery.min.js"></script>
	<script src="../bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
	<style>
		#pageTitle::before {
			content: "Troubleshooting RETCODE137 Errors";
		} 
	</style>
	<link href="../css/documentation.css" rel="stylesheet">
	<link href="../documentation-favicon.ico" rel="shortcut icon" type="image/png">
	<title>RETCODE137 Errors</title>
</head>
<body>
<div w3-include-html="/documentation/pageHeader.html" id="pageHeader"></div>
<div class="Layout">
<div class="Layout-sidebar" w3-include-html="/documentation/sidebar.html" id="sidebar"></div>
<div class="Layout-main markdown-body" id="mainContents">

<p>
When a Linux command (for example, <code>date</code>) completes,
it has an exit code, also called a "return code" or "RETCODE".
By convention, a code of <b>0</b> means the command
was successful and a non-zero code means there was some problem.
The developer of the command specifies what each non-zero code means.
When Allsky commands detect an issue, like a required file not found,
they print an error message then exit with a non-zero code.
</p>
<p>
An exit code of <b>137</b> usually means the command was forcefully killed by an outside source,
often the Linux kernel.
The command just stopped with no warning.
When this happens to an Allsky command, the log file will usually contain a message
with <b>Killed</b> in it, and often with <b>RETCODE=137</b> in it.
</p>
<p>
If you are using a RPi HQ camera and get a notification message saying
<code>ERROR  See /var/log/allsky.log for details</code>
and the log file contains entries similar to these:
<pre>
Jan 20 18:45:50 allsky allsky.sh[4480]: /home/pi/allsky/allsky.sh: line 225:  4562 Killed "${ALLSKY_HOME}/${CAPTURE}" "${ARGUMENTS[@]}"
Jan 20 18:45:50 allsky allsky.sh[4480]: 'capture_RPiHQ' exited with RETCODE=137
</pre>
that usually means the Linux kernel killed the command because it was using
more memory than was available.
This can also happen when
<a allsky="true" href="timelapse.html">a timelapse is being created</a>,
and the solution is the same -
<a allsky="true" href="increaseSwap.html">increase swap space</a>.
</p>
<p>
<blockquote>
The installation of Allsky checked if additional swap space was needed,
and if so, prompted you to add it.
If you are seeing this problem you either didn't add swap space,
or additional space is needed.
</blockquote>
</p>
<p>
This problem happens more often on Pi's with small amounts of memory such as the Pi Zero
with only 512 MB.
It's less likely (although still possible) on a Pi 4 with 4 or 8 GB of memory.
</p>


</div><!-- Layout-main -->
</div><!-- Layout -->
</body>
</html>
<script> includeHTML(); </script>

