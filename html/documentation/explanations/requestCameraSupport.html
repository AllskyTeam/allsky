<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="../js/documentation.js" type="application/javascript"></script>
    <link href="../css/light.css" rel="stylesheet">
	<link href="../bower_components/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
	<script src="../bower_components/jquery/dist/jquery.min.js"></script>
	<script src="../bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
	<style>
		#pageTitle::before {
			content: "Request support for camera"
		} 
	</style>
    <link href="../css/documentation.css" rel="stylesheet">
    <link href="../documentation-favicon.ico" rel="shortcut icon" type="image/png">
	<script src="../js/all.min.js" type="application/javascript"></script>
	<title>Request camera support</title>
</head>
<body>
<div w3-include-html="/documentation/pageHeader.html" id="pageHeader"></div>
<div class="Layout">
<div class="Layout-sidebar" w3-include-html="/documentation/sidebar.html" id="sidebar"></div>
<div class="Layout-main markdown-body" id="mainContents">

<p>
This page describes how to request that Allsky support a camera.
</p>

<h2>ZWO Cameras</h2>
<p>
Open a new
<a external="true" href="https://github.com/AllskyTeam/allsky/discussions">Discussion</a>
in GitHub using the <strong>New feature requests</strong> category.
Let us know what model of ZWO camera it is, and if you know it, when the camera came out.
</p>
<p>
Allsky uses a library provided by ZWO, and that library determines what cameras are supported.
ZWO comes out with a new library every few months, so if your camera isn't supported that
means the camera is newer than the library Allsky is using.
</p>
<p>
We normally update the library when we release a new Allsky version.
If you can't wait for the next version you can download the newest ZWO library
then copy the <span class="fileName">libASICamera2.a</span> files from the
library to the various <span class="fileName">~/allsky/src/lib</span> directories
on the Pi,
then execute:
<pre>
cd ~/allsky/src
make capture_ZWO
sudo systemctl stop allsky
cp capture_ZWO ../bin
sudo systemctl start allsky
</pre>
Allsky should now recognize your camera.
</p>
<h2>RPi and Compatible Cameras</h2>
<h3>Step 1: Check if camera is good for allsky</h3>
<p>
<blockquote class="warning">
The maximum exposure times of many RPi and compatible cameras are very short,
e.g., 15 seconds, so do not make very good allsky cameras.
Before requesting that Allsky support a camera
(and ideally before you purchase the camera),
make sure it'll make a good allsky camera.
</blockquote>
Connect the camera to the Pi and run the following:
<pre>
cd ~/allsky/tmp
export LIBCAMERA_LOG_LEVELS=ERROR,FATAL
{
echo -e "===== libcamera-still --list-cameras"
libcamera-still --list-cameras
} | tee list-cameras.txt
</pre>
</p>
<p>
You should see an entry similar to the following
(copy and paste these commands into a terminal window on the Pi):
<pre>
0 : imx477 [4056x3040 12-bit RGGB] (/base/axi/pcie@120000/rp1/i2c@88000/imx477@1a)
    Modes: 'SRGGB10_CSI2P' : 1332x990 [120.05 fps - (696, 528)/2664x1980 crop]
           'SRGGB12_CSI2P' : 2028x1080 [50.03 fps - (0, 440)/4056x2160 crop]
                             2028x1520 [40.01 fps - (0, 0)/4056x3040 crop]
                             4056x3040 [10.00 fps - (0, 0)/4056x3040 crop]
</pre>
<strong>imx477</strong> is the sensor the RPi HQ camera uses.
Yours will be different.
</p>
<p>
Now, take a picture with the camera to determine what its capabilities are:
<pre>
{
echo -e "===== libcamera-still"
libcamera-still -v --metadata - --nopreview --timeout 1 --shutter 1 --output /dev/null 2&gt;&amp;1
} | tee libcamera-still | grep -E "ExposureTime :|FrameDurationLimits :" | tail -2
</pre>
</p>
<p>
You'll see something like:
<pre>
    ExposureTime : [114..674191602]
    FrameDurationLimits : [100000..694434742]
</pre>
</p>
<p>
Each line has two numbers;
looking only at the SECOND number on each line determine which number is larger
(<strong>694434742</strong> in this example).
Remove the 6 right-most digits from that number
and that's the maximum number of seconds exposure the sensor supports.
In the above example, removing the right-most 6 digits from <strong>694434742</strong>
leaves <strong>694</strong> seconds.
</p>
<p>
If the number of seconds is too small you'll probably want to look for another camera.
Do NOT request support for the camera since it's likely no one else will use it either.
</p>

<h3>Step 2: If good, request support</h3>
If the longest exposure the camera supports is enough for you, open a new
<a external="true" href="https://github.com/AllskyTeam/allsky/discussions">Discussion</a>
in GitHub using the <strong>New feature requests</strong> category.
Attach the <span class="fileName">list-cameras.txt</span>
and <span class="fileName">libcamera-still</span>
files you created above as well as a URL for information on the camera
(often a URL of where you bought the camera).
</p>

</div><!-- Layout-main -->
</div><!-- Layout -->
</body>
</html>
<script> includeHTML(); </script>
